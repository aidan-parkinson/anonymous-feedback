{"version":3,"sources":["components/affective-response/star-rating.js","components/form/form.js","components/form/formWrapper.js"],"names":["StarRating","props","hoverHandler","ev","stars","target","parentElement","getElementsByClassName","hoverValue","dataset","value","Array","from","forEach","star","style","color","setRating","refs","rating","state","currentRating","starClickHandler","setState","onClick","this","className","ref","data-rating","onMouseOut","numberOfStars","keys","map","n","key","data-value","onMouseOver","Component","Form","handleChange","name","broadcastFeedback","client","publish","JSON","stringify","likert_score","description","retain","window","location","reload","options","ca","caFile","rejectUnauthorized","qos","mqtt","connect","console","log","connected","on","id","onChange","placeholder","React","FormWrapper","useState","setCaFile","useEffect","fs","e"],"mappings":"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","file":"static/js/3.ada68d3e.chunk.js","sourcesContent":["import React, { Component } from 'react';\n\nimport './star-rating.css';\n\nclass StarRating extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentRating: this.props.currentRating\n    };\n  }\n\n  componentDidMount() {\n    this.setRating();\n  }\n\n  hoverHandler = ev => {\n    const stars = ev.target.parentElement.getElementsByClassName('star');\n    const hoverValue = ev.target.dataset.value;\n    Array.from(stars).forEach(star => {\n      star.style.color = hoverValue >= star.dataset.value ? `#C1F0FF` : 'gray';\n    });\n  };\n\n  setRating = ev => {\n    const stars = this.refs.rating.getElementsByClassName('star');\n    Array.from(stars).forEach(star => {\n      star.style.color =\n        this.state.currentRating >= star.dataset.value ? `#C1F0FF` : 'gray';\n    });\n  };\n\n  starClickHandler = ev => {\n    let rating = ev.target.dataset.value;\n    this.setState({ currentRating: rating }); // set state so the rating stays highlighted\n    if(this.props.onClick){\n      this.props.onClick(rating); // emit the event up to the parent\n    }\n  };\n\n  render() {\n    return (\n      <div\n        className=\"rating\"\n        ref=\"rating\"\n        data-rating={this.state.currentRating}\n        onMouseOut={this.setRating}\n      >\n        {[...Array(+this.props.numberOfStars).keys()].map(n => {\n          return (\n            <span\n              className=\"star\"\n              key={n+1}\n              data-value={n+1}\n              onMouseOver={this.hoverHandler}\n              onClick={this.starClickHandler}\n            >\n              &#9733;\n            </span>\n          );\n        })}\n      </div>\n    );\n  }\n}\n\nexport default StarRating;\n","import React from 'react';\n\nimport './form.css';\nimport StarRating from '../affective-response/star-rating';\nimport mqtt from 'mqtt';\n\nclass Form extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      rating: null,\n      description: null\n    };\n\n    this.options = {\n        // clientId: JSON.stringify(macaddress.networkInterfaces(), null, 2),\n        // port: 8883,\n        // host: '35.176.252.212',\n        // key: KEY,\n        ca: this.props.caFile,\n        rejectUnauthorized: false,\n        // The CA list will be used to determine if server is authorized\n        // protocol: 'mqtts'\n    }\n\n    this.retain = {\n      retain: true,\n      qos:1\n    };\n\n    this.client = mqtt.connect(\"wss://wss.aidanparkinson.xyz:8081\", this.options);\n    console.log(\"connected flag  \" + this.client.connected);\n\n    this.client.on(\"connect\",function(){\n    console.log(\"connected  \"+ this.client.connected);\n    })\n  }\n\n  handleChange = ev => {\n    this.setState({\n      [ev.target.name]: ev.target.value\n    });\n  };\n\n  setRating = rating => {\n    this.setState({ rating: rating });\n  };\n\n  broadcastFeedback = () => {\n    this.client.publish(`anonymous-feedback/json`, JSON.stringify({likert_score: this.state.rating, description: this.state.description}), this.retain);\n    this.setState({ rating: null, description: null});\n    window.location.reload(false);\n  };\n\n  render() {\n   return (\n      <div>\n        <div className=\"form-input\">\n          <div className=\"form-input-rating\">\n            <StarRating\n              numberOfStars=\"5\"\n              currentRating={null}\n              onClick={this.setRating}\n            />\n          </div>\n          <div className=\"actions\">\n            <button onClick={this.broadcastFeedback}>\n              Submit\n            </button>\n          </div>\n          <textarea\n            name=\"description\"\n            id=\"description\"\n            onChange={this.handleChange}\n            placeholder=\"A description of your experience...\"\n            />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Form\n","import * as fs from 'fs';\nimport React, { useState, useEffect } from 'react';\nimport Form from \"./form\";\n\nconst FormWrapper = () => {\n  const [caFile, setCaFile] = useState(null);\n\n  useEffect (() => {\n    let ca = null;\n    console.log(\"a\");\n\n    try {\n      ca = fs.readFileSync('/etc/ssl/certs/learning-iot-ca.crt');\n      console.log(\"b\");\n    }\n    catch(e) {\n      console.log(\"c\");\n      console.log(e);\n    }\n\n    if (ca) {\n      setCaFile(ca);\n    }\n    console.log(caFile);\n  }, [])\n\n  if (!caFile) {\n    return(\n      <div>\n        <div className=\"instruction\">\n          you do not have the correct certificate saved on your system..<br/>\n          to download the latest ca certificate to appropriate folder:<br/>\n        </div>\n        <div className=\"bash\">\n          `cd /etc/ssl/certs`<br/>\n          `sudo rm learning-iot-ca.crt`<br/>\n          `sudo curl -0 https://learning-iot.aidanparkinson.xyz -o learning-iot-ca.crt`\n        </div>\n      </div>)\n  }\n\n  return (\n    <Form caFile={caFile}/>\n    )\n}\n\nexport default FormWrapper;\n"],"sourceRoot":""}